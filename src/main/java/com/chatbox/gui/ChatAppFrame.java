/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package com.chatbox.gui;

import com.chatbox.dao.UserService;
import com.chatbox.dto.User;
import com.chatbox.exception.AppException;

/**
 *
 * @author vigneshwaran
 */
public class ChatAppFrame extends javax.swing.JFrame {

    /**
     * Creates new form ChatAppFrame
     */
    public ChatAppFrame() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        javax.swing.JPanel header = new javax.swing.JPanel();
        headerLabel = new javax.swing.JLabel();
        bodyTabbedPanel = new javax.swing.JTabbedPane();
        chatPanel = new javax.swing.JPanel();
        registerForm = new javax.swing.JPanel();
        nameLabel1 = new javax.swing.JLabel();
        registerNameInput = new javax.swing.JTextField();
        regispasswordLabel = new javax.swing.JLabel();
        registerPasswordInput = new javax.swing.JPasswordField();
        registerButton = new javax.swing.JButton();
        registerPopupMessage = new javax.swing.JLabel();
        loginPanel = new javax.swing.JPanel();
        nameLabel = new javax.swing.JLabel();
        nameInput = new javax.swing.JTextField();
        passwordLabel = new javax.swing.JLabel();
        passwordInput = new javax.swing.JPasswordField();
        loginButton = new javax.swing.JButton();
        popupMessage = new javax.swing.JLabel();
        loginMessagePanel = new javax.swing.JPanel();
        loginMessage = new javax.swing.JLabel();
        goToRegisterButton = new javax.swing.JButton();
        homePanel = new javax.swing.JPanel();
        hiLabel = new javax.swing.JLabel();
        welcomeUserNameLabel = new javax.swing.JLabel();
        goToJoinAGroup = new javax.swing.JButton();
        goToGroupCreation = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setBounds(new java.awt.Rectangle(0, 0, 900, 600));
        setMaximumSize(new java.awt.Dimension(900, 600));
        setMinimumSize(new java.awt.Dimension(900, 600));
        setResizable(false);
        getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        header.setBackground(new java.awt.Color(0, 0, 0));

        headerLabel.setFont(new java.awt.Font("Liberation Sans", 0, 24)); // NOI18N
        headerLabel.setForeground(new java.awt.Color(255, 255, 255));
        headerLabel.setText("ChatBox");

        javax.swing.GroupLayout headerLayout = new javax.swing.GroupLayout(header);
        header.setLayout(headerLayout);
        headerLayout.setHorizontalGroup(
            headerLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, headerLayout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(headerLabel)
                .addGap(485, 485, 485))
        );
        headerLayout.setVerticalGroup(
            headerLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(headerLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(headerLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        getContentPane().add(header, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 1081, -1));

        bodyTabbedPanel.setBackground(new java.awt.Color(0, 255, 255));
        bodyTabbedPanel.setMaximumSize(new java.awt.Dimension(900, 581));

        javax.swing.GroupLayout chatPanelLayout = new javax.swing.GroupLayout(chatPanel);
        chatPanel.setLayout(chatPanelLayout);
        chatPanelLayout.setHorizontalGroup(
            chatPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 1081, Short.MAX_VALUE)
        );
        chatPanelLayout.setVerticalGroup(
            chatPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 749, Short.MAX_VALUE)
        );

        bodyTabbedPanel.addTab("tab2", chatPanel);

        nameLabel1.setFont(new java.awt.Font("Liberation Sans", 0, 18)); // NOI18N
        nameLabel1.setText("Name");

        registerNameInput.setFont(new java.awt.Font("Liberation Sans", 0, 18)); // NOI18N
        registerNameInput.setToolTipText("Name");

        regispasswordLabel.setFont(new java.awt.Font("Liberation Sans", 0, 18)); // NOI18N
        regispasswordLabel.setText("Password");

        registerPasswordInput.setToolTipText("Passowrd");

        registerButton.setBackground(new java.awt.Color(0, 0, 0));
        registerButton.setFont(new java.awt.Font("Liberation Sans", 1, 18)); // NOI18N
        registerButton.setForeground(new java.awt.Color(255, 255, 255));
        registerButton.setText("Register");
        registerButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                onRegister(evt);
            }
        });

        registerPopupMessage.setForeground(new java.awt.Color(255, 0, 0));

        javax.swing.GroupLayout registerFormLayout = new javax.swing.GroupLayout(registerForm);
        registerForm.setLayout(registerFormLayout);
        registerFormLayout.setHorizontalGroup(
            registerFormLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(registerFormLayout.createSequentialGroup()
                .addGap(90, 90, 90)
                .addGroup(registerFormLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(registerPopupMessage, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(registerFormLayout.createSequentialGroup()
                        .addComponent(nameLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 90, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(10, 10, 10)
                        .addComponent(registerNameInput, javax.swing.GroupLayout.PREFERRED_SIZE, 190, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(registerFormLayout.createSequentialGroup()
                        .addComponent(regispasswordLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 90, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(10, 10, 10)
                        .addComponent(registerPasswordInput, javax.swing.GroupLayout.PREFERRED_SIZE, 190, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(registerButton))
                .addContainerGap(701, Short.MAX_VALUE))
        );
        registerFormLayout.setVerticalGroup(
            registerFormLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(registerFormLayout.createSequentialGroup()
                .addGap(91, 91, 91)
                .addComponent(registerPopupMessage, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addGroup(registerFormLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(nameLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(registerNameInput, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(30, 30, 30)
                .addGroup(registerFormLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(regispasswordLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(registerPasswordInput, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(40, 40, 40)
                .addComponent(registerButton)
                .addContainerGap(462, Short.MAX_VALUE))
        );

        bodyTabbedPanel.addTab("tab3", registerForm);

        loginPanel.setBackground(new java.awt.Color(0, 255, 255));
        loginPanel.setMaximumSize(new java.awt.Dimension(900, 550));
        loginPanel.setMinimumSize(new java.awt.Dimension(900, 550));
        loginPanel.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        nameLabel.setFont(new java.awt.Font("Liberation Sans", 0, 18)); // NOI18N
        nameLabel.setText("Name");
        loginPanel.add(nameLabel, new org.netbeans.lib.awtextra.AbsoluteConstraints(70, 180, 90, 30));

        nameInput.setFont(new java.awt.Font("Liberation Sans", 0, 18)); // NOI18N
        nameInput.setToolTipText("Name");
        loginPanel.add(nameInput, new org.netbeans.lib.awtextra.AbsoluteConstraints(170, 180, 190, 30));

        passwordLabel.setFont(new java.awt.Font("Liberation Sans", 0, 18)); // NOI18N
        passwordLabel.setText("Password");
        loginPanel.add(passwordLabel, new org.netbeans.lib.awtextra.AbsoluteConstraints(70, 240, 90, 30));

        passwordInput.setToolTipText("Passowrd");
        loginPanel.add(passwordInput, new org.netbeans.lib.awtextra.AbsoluteConstraints(170, 240, 190, 30));

        loginButton.setBackground(new java.awt.Color(0, 0, 0));
        loginButton.setFont(new java.awt.Font("Liberation Sans", 1, 18)); // NOI18N
        loginButton.setForeground(new java.awt.Color(255, 255, 255));
        loginButton.setText("Login");
        loginButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                onLogin(evt);
            }
        });
        loginPanel.add(loginButton, new org.netbeans.lib.awtextra.AbsoluteConstraints(70, 310, -1, -1));

        popupMessage.setForeground(new java.awt.Color(255, 0, 0));
        loginPanel.add(popupMessage, new org.netbeans.lib.awtextra.AbsoluteConstraints(70, 150, 140, 20));

        loginMessagePanel.setBackground(new java.awt.Color(0, 0, 0));
        loginMessagePanel.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.LOWERED));

        loginMessage.setBackground(new java.awt.Color(0, 0, 0));
        loginMessage.setFont(new java.awt.Font("Liberation Sans", 0, 36)); // NOI18N
        loginMessage.setForeground(new java.awt.Color(255, 255, 255));
        loginMessage.setText("Everyone is waiting for you ...");

        javax.swing.GroupLayout loginMessagePanelLayout = new javax.swing.GroupLayout(loginMessagePanel);
        loginMessagePanel.setLayout(loginMessagePanelLayout);
        loginMessagePanelLayout.setHorizontalGroup(
            loginMessagePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(loginMessagePanelLayout.createSequentialGroup()
                .addGap(46, 46, 46)
                .addComponent(loginMessage, javax.swing.GroupLayout.PREFERRED_SIZE, 475, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(43, Short.MAX_VALUE))
        );
        loginMessagePanelLayout.setVerticalGroup(
            loginMessagePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(loginMessagePanelLayout.createSequentialGroup()
                .addGap(86, 86, 86)
                .addComponent(loginMessage, javax.swing.GroupLayout.PREFERRED_SIZE, 101, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(307, Short.MAX_VALUE))
        );

        loginPanel.add(loginMessagePanel, new org.netbeans.lib.awtextra.AbsoluteConstraints(480, 30, 570, 500));

        goToRegisterButton.setBackground(new java.awt.Color(0, 0, 0));
        goToRegisterButton.setFont(new java.awt.Font("Liberation Sans", 1, 18)); // NOI18N
        goToRegisterButton.setForeground(new java.awt.Color(255, 255, 255));
        goToRegisterButton.setText("Register");
        goToRegisterButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                goToRegisterPanel(evt);
            }
        });
        loginPanel.add(goToRegisterButton, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 310, -1, -1));

        bodyTabbedPanel.addTab("tab1", loginPanel);

        hiLabel.setFont(new java.awt.Font("Liberation Sans", 0, 36)); // NOI18N
        hiLabel.setText("Hi");

        welcomeUserNameLabel.setFont(new java.awt.Font("Liberation Sans", 0, 36)); // NOI18N

        goToJoinAGroup.setFont(new java.awt.Font("Liberation Sans", 0, 24)); // NOI18N
        goToJoinAGroup.setText("Join a Group");

        goToGroupCreation.setFont(new java.awt.Font("Liberation Sans", 0, 24)); // NOI18N
        goToGroupCreation.setText("Create a Group");

        javax.swing.GroupLayout homePanelLayout = new javax.swing.GroupLayout(homePanel);
        homePanel.setLayout(homePanelLayout);
        homePanelLayout.setHorizontalGroup(
            homePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(homePanelLayout.createSequentialGroup()
                .addGap(334, 334, 334)
                .addGroup(homePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(homePanelLayout.createSequentialGroup()
                        .addComponent(goToJoinAGroup)
                        .addGap(50, 50, 50)
                        .addComponent(goToGroupCreation))
                    .addGroup(homePanelLayout.createSequentialGroup()
                        .addComponent(hiLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 45, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(welcomeUserNameLabel)))
                .addContainerGap(332, Short.MAX_VALUE))
        );
        homePanelLayout.setVerticalGroup(
            homePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(homePanelLayout.createSequentialGroup()
                .addGap(113, 113, 113)
                .addGroup(homePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(hiLabel)
                    .addComponent(welcomeUserNameLabel))
                .addGap(82, 82, 82)
                .addGroup(homePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(goToJoinAGroup)
                    .addComponent(goToGroupCreation))
                .addContainerGap(478, Short.MAX_VALUE))
        );

        bodyTabbedPanel.addTab("tab4", homePanel);

        getContentPane().add(bodyTabbedPanel, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 20, 1081, 780));

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void onLogin(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_onLogin
        String userName = nameInput.getText();
        String userPassword = new String(passwordInput.getPassword());
        
        try {
            if(!UserService.getInstance().isValidUser(userName, userPassword)) {
                popupMessage.setText("Invalid credintials");
                return;
            }
            showHomePage(UserService.getInstance().findByUserName(userName).get());
        }
        catch(AppException e) {
            popupMessage.setText(e.getMessage());
        }
    }//GEN-LAST:event_onLogin

    private void onRegister(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_onRegister
        String userName = registerNameInput.getText();
        String userPassword = new String(registerPasswordInput.getPassword());
        
        try {
            Long userId = UserService.getInstance().addUser(userName, userPassword);
            if(userId == -1) {
                registerPopupMessage.setText("Error while creating user");
                return;
            }    
            showHomePage(new User(userId, userName));
        }
        catch(AppException e) {
            registerPopupMessage.setText(e.getMessage());
        }
    }//GEN-LAST:event_onRegister

    private void goToRegisterPanel(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_goToRegisterPanel
        showReigsterPanel();
    }//GEN-LAST:event_goToRegisterPanel

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(ChatAppFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(ChatAppFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(ChatAppFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(ChatAppFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new ChatAppFrame().setVisible(true);
            }
        });
    }
    
    public void showLoginPage() {
        bodyTabbedPanel.setSelectedIndex(2);
    }
    
    public void showHomePage(User user) {
        bodyTabbedPanel.setSelectedIndex(3);
        welcomeUserNameLabel.setText(user.getName());
    }
    
    public void showReigsterPanel() {
        bodyTabbedPanel.setSelectedIndex(1);
    }
        

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTabbedPane bodyTabbedPanel;
    private javax.swing.JPanel chatPanel;
    private javax.swing.JButton goToGroupCreation;
    private javax.swing.JButton goToJoinAGroup;
    private javax.swing.JButton goToRegisterButton;
    private javax.swing.JLabel headerLabel;
    private javax.swing.JLabel hiLabel;
    private javax.swing.JPanel homePanel;
    private javax.swing.JButton loginButton;
    private javax.swing.JLabel loginMessage;
    private javax.swing.JPanel loginMessagePanel;
    private javax.swing.JPanel loginPanel;
    private javax.swing.JTextField nameInput;
    private javax.swing.JLabel nameLabel;
    private javax.swing.JLabel nameLabel1;
    private javax.swing.JPasswordField passwordInput;
    private javax.swing.JLabel passwordLabel;
    private javax.swing.JLabel popupMessage;
    private javax.swing.JLabel regispasswordLabel;
    private javax.swing.JButton registerButton;
    private javax.swing.JPanel registerForm;
    private javax.swing.JTextField registerNameInput;
    private javax.swing.JPasswordField registerPasswordInput;
    private javax.swing.JLabel registerPopupMessage;
    private javax.swing.JLabel welcomeUserNameLabel;
    // End of variables declaration//GEN-END:variables
}
